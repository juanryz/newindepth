import{u as c,d as x,j as e,H,L as I}from"./app-BefH0Fc6.js";import{A as F}from"./AuthenticatedLayout-DEE6Garv.js";import{M as f,S as j}from"./SecondaryButton-DjPhZRr0.js";import{I as n}from"./InputLabel-DvEIRvuS.js";import"./transition-BJdfc5F8.js";import"./ThemeToggle-UQCXlGRP.js";import"./LiquidBackground-D42omu_m.js";import"./with-selector-IRDYUTaH.js";function O({bookings:h,therapists:w,availableSchedules:k=[]}){const{data:p,setData:m,patch:N,processing:v}=c({therapist_id:""}),[y,i]=x.useState(null),[t,l]=x.useState(null),[d,r]=x.useState(null),{data:o,setData:u,post:_,processing:S,reset:B}=c({new_schedule_id:"",reschedule_reason:""}),{data:g,setData:b,post:D,processing:C,reset:L}=c({no_show_party:"therapist",no_show_reason:""}),P=a=>{N(route("admin.bookings.assign-therapist",a),{onSuccess:()=>i(null)})},T=a=>{a.preventDefault(),_(route("admin.bookings.reschedule",t.id),{onSuccess:()=>{l(null),B()}})},A=a=>{a.preventDefault(),D(route("admin.bookings.no-show",d.id),{onSuccess:()=>{r(null),L()}})},M=a=>{const s={pending_screening:"bg-yellow-100 text-yellow-800",pending_payment:"bg-blue-100 text-blue-800",pending_validation:"bg-indigo-100 text-indigo-800",confirmed:"bg-green-100 text-green-800",completed:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"},R={pending_screening:"Menunggu Skrining",pending_payment:"Menunggu Pembayaran",pending_validation:"Menunggu Validasi",confirmed:"Dikonfirmasi",completed:"Selesai",cancelled:"Dibatalkan"};return e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s[a]||s.pending_payment}`,children:R[a]||a})};return e.jsxs(F,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Manajemen Booking Pasien"}),children:[e.jsx(H,{title:"Booking Pasien"}),e.jsxs("div",{className:"relative py-12 bg-slate-50 dark:bg-slate-950 min-h-screen overflow-hidden transition-colors duration-700",children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none opacity-40 dark:opacity-20 z-0",children:[e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[60%] h-[60%] bg-gradient-to-br from-indigo-400/30 to-purple-500/30 blur-[120px] rounded-full animate-pulse",style:{animationDuration:"10s"}}),e.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-[50%] h-[50%] bg-gradient-to-tr from-cyan-400/20 to-emerald-400/20 blur-[100px] rounded-full animate-pulse",style:{animationDuration:"15s",animationDelay:"2s"}})]}),e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-8 relative z-10",children:[e.jsx("div",{className:"bg-white/60 dark:bg-slate-900/40 backdrop-blur-2xl border border-white dark:border-slate-800 p-8 sm:p-10 rounded-[3rem] shadow-[0_20px_50px_rgba(0,0,0,0.05)] dark:shadow-none transition-all duration-500",children:e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-8",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-black text-slate-900 dark:text-white tracking-tight",children:["Booking ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-indigo-400",children:"Pasien"})]}),e.jsx("p",{className:"mt-2 text-slate-500 dark:text-slate-400 font-bold italic tracking-wide",children:"Pantau skrining, pembayaran, dan penugasan terapis."})]})})}),e.jsx("div",{className:"bg-white/70 dark:bg-slate-900/40 backdrop-blur-3xl border border-white dark:border-slate-800 rounded-[3.5rem] shadow-[0_30px_100px_rgba(0,0,0,0.1)] dark:shadow-none overflow-hidden transition-all duration-700",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-slate-100/50 dark:bg-slate-800/50",children:e.jsxs("tr",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.15em] border-b border-white/40 dark:border-slate-700/30",children:[e.jsx("th",{className:"px-8 py-5",children:"Info Booking"}),e.jsx("th",{className:"px-8 py-5",children:"Pasien & Screening"}),e.jsx("th",{className:"px-8 py-5",children:"Jadwal Sesi"}),e.jsx("th",{className:"px-8 py-5 text-center",children:"Status"}),e.jsx("th",{className:"px-8 py-5",children:"Terapis & Aksi"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800/50",children:[h.map(a=>e.jsxs("tr",{className:"group hover:bg-slate-50/50 dark:hover:bg-slate-800/20 transition-all",children:[e.jsx("td",{className:"px-8 py-6",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-black text-slate-900 dark:text-white mb-1",children:a.booking_code}),e.jsx("span",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-400 uppercase tracking-widest bg-indigo-50 dark:bg-indigo-900/30 px-2 py-0.5 rounded-md w-fit",children:a.package_type?.toUpperCase()||"KONSULTASI"})]})}),e.jsx("td",{className:"px-8 py-6",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:a.patient?.name}),e.jsx("div",{className:"text-xs text-slate-500",children:a.patient?.email})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"w-24 bg-slate-200 dark:bg-slate-700 rounded-full h-1 my-1",children:e.jsx("div",{className:`h-1 rounded-full ${a.patient_profile_stats?.percentage===100?"bg-emerald-500":"bg-amber-500"}`,style:{width:`${a.patient_profile_stats?.percentage||0}%`}})}),e.jsxs("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-tighter",children:[a.patient_profile_stats?.percentage||0,"% Profil"]})]}),a.patient?.screening_completed_at?e.jsxs("div",{className:"flex flex-col border-l border-slate-200 dark:border-slate-700 pl-4",children:[e.jsx("span",{className:"text-[9px] font-black text-emerald-500 uppercase tracking-tighter",children:"Skrining OK"}),e.jsx("span",{className:"text-[10px] text-slate-400 truncate max-w-[120px]",children:a.patient.recommended_package||"No Rec"})]}):e.jsx("span",{className:"text-[9px] font-black text-rose-500 uppercase border-l border-slate-200 dark:border-slate-700 pl-4",children:"Belum Skrining"})]})]})}),e.jsx("td",{className:"px-8 py-6",children:a.schedule?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:new Date(a.schedule.date).toLocaleDateString("id-ID",{day:"numeric",month:"short"})}),e.jsxs("span",{className:"text-xs text-slate-500",children:[a.schedule.start_time?.substring(0,5)," WIB"]})]}):e.jsx("span",{className:"text-xs text-slate-400 italic",children:"No Slot"})}),e.jsx("td",{className:"px-8 py-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[M(a.status),e.jsxs("div",{className:"flex items-center gap-1.5 opacity-40 group-hover:opacity-100 transition-opacity",children:[a.recording_link&&e.jsx("div",{className:"w-5 h-5 rounded-lg bg-indigo-50 dark:bg-indigo-900/40 flex items-center justify-center text-indigo-500",title:"Ada Rekaman",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),a.therapist_notes&&e.jsx("div",{className:"w-5 h-5 rounded-lg bg-slate-50 dark:bg-slate-900/40 flex items-center justify-center text-slate-500",title:"Ada Catatan Klinis",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})]})}),e.jsx("td",{className:"px-8 py-6",children:e.jsx("div",{className:"flex flex-col gap-4",children:y===a.id?e.jsxs("div",{className:"flex flex-col gap-2 bg-white/80 dark:bg-slate-800/80 backdrop-blur p-4 rounded-2xl border border-white dark:border-slate-700 shadow-xl",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:"Assign Terapis"}),e.jsxs("select",{className:"text-xs bg-slate-50 dark:bg-slate-900 border-none rounded-xl focus:ring-2 focus:ring-indigo-500/20",value:p.therapist_id,onChange:s=>m("therapist_id",s.target.value),children:[e.jsx("option",{value:"",children:"Pilih Terapis"}),w.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:()=>P(a.id),className:"flex-1 py-1.5 bg-indigo-600 text-white text-[10px] font-black uppercase rounded-lg hover:bg-indigo-700 transition-all",disabled:v||!p.therapist_id,children:"Simpan"}),e.jsx("button",{onClick:()=>i(null),className:"flex-1 py-1.5 bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300 text-[10px] font-black uppercase rounded-lg",children:"Batal"})]})]}):e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between group/tp",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-0.5",children:"Penanggung Jawab"}),a.therapist?e.jsx("span",{className:"text-xs font-bold text-slate-900 dark:text-white",children:a.therapist.name}):e.jsx("span",{className:"text-xs font-bold text-amber-500 dark:text-amber-400",children:["pending_payment","pending_validation"].includes(a.status)?"⏳ Otomatis setelah bayar":"BELUM DITUNJUK"})]}),e.jsx("button",{onClick:()=>{i(a.id),m("therapist_id",a.therapist_id||"")},className:"p-2 text-indigo-500 hover:text-indigo-700 bg-indigo-50 dark:bg-indigo-900/30 rounded-xl opacity-0 group-hover:opacity-100 group-hover/tp:opacity-100 transition-all",title:"Ganti Terapis",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-slate-100 dark:border-slate-800/50",children:[a.schedule_id&&e.jsx(I,{href:route("admin.schedules.show",a.schedule_id),className:"flex-1 text-center py-2 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-400 text-[9px] font-black uppercase tracking-widest rounded-xl border border-slate-200 dark:border-slate-700 hover:border-indigo-500/50 hover:text-indigo-500 transition-all",children:"Detail Sesi"}),["confirmed","in_progress"].includes(a.status)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>l(a),className:"px-2 py-2 bg-amber-500 text-white text-[9px] font-black uppercase tracking-widest rounded-xl hover:bg-amber-600 transition-all shadow-lg shadow-amber-500/20",children:"Reschedule"}),e.jsx("button",{onClick:()=>r(a),className:"px-2 py-2 bg-rose-500 text-white text-[9px] font-black uppercase tracking-widest rounded-xl hover:bg-rose-600 transition-all shadow-lg shadow-rose-500/20",children:"No-Show"})]})]})]})})})]},a.id)),h.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-8 py-20 text-center",children:e.jsx("p",{className:"text-slate-500 dark:text-slate-600 font-bold italic",children:"Belum ada booking pasien yang terdaftar."})})})]})]})})})]})]}),e.jsx(f,{show:t!==null,onClose:()=>l(null),children:e.jsxs("form",{onSubmit:T,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Reschedule Sesi"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-6",children:["Pasien: ",e.jsx("strong",{children:t?.patient?.name}),e.jsx("br",{}),"Jadwal saat ini: ",t?.schedule?.date," pukul ",t?.schedule?.start_time?.substring(0,5)]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{htmlFor:"new_schedule_id",value:"Pilih Jadwal Baru"}),e.jsxs("select",{id:"new_schedule_id",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm",value:o.new_schedule_id,onChange:a=>u("new_schedule_id",a.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Pilih Slot Tersedia --"}),k.filter(a=>a.id!==t?.schedule_id).map(a=>e.jsxs("option",{value:a.id,children:[a.therapist?.name," — ",new Date(a.date).toLocaleDateString("id-ID",{day:"numeric",month:"short"})," — ",a.start_time?.substring(0,5)]},a.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{htmlFor:"reschedule_reason",value:"Alasan Reschedule"}),e.jsx("textarea",{id:"reschedule_reason",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm",rows:"2",placeholder:"Tuliskan alasan perubahan jadwal...",value:o.reschedule_reason,onChange:a=>u("reschedule_reason",a.target.value),required:!0}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"* Pesan ini akan diinformasikan ke pelanggan."})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(j,{onClick:()=>l(null),children:"Batal"}),e.jsx("button",{type:"submit",disabled:S||!o.new_schedule_id,className:"inline-flex items-center px-4 py-2 bg-amber-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-amber-700 disabled:opacity-25 transition",children:"Update Jadwal"})]})]})}),e.jsx(f,{show:d!==null,onClose:()=>r(null),children:e.jsxs("form",{onSubmit:A,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-1",children:"Tandai Tidak Hadir"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-6",children:[" Booking Code: ",d?.booking_code," "]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{htmlFor:"no_show_party",value:"Pihak yang Tidak Hadir"}),e.jsxs("select",{id:"no_show_party",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",value:g.no_show_party,onChange:a=>b("no_show_party",a.target.value),required:!0,children:[e.jsx("option",{value:"therapist",children:"Praktisi (Tidak Hadir)"}),e.jsx("option",{value:"patient",children:"Pasien (Tidak Hadir)"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(n,{htmlFor:"no_show_reason",value:"Keterangan Admin"}),e.jsx("textarea",{id:"no_show_reason",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-red-500 focus:ring-red-500 text-sm",rows:"2",placeholder:"Alasan ketidakhadiran...",value:g.no_show_reason,onChange:a=>b("no_show_reason",a.target.value)})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(j,{onClick:()=>r(null),children:"Batal"}),e.jsx("button",{type:"submit",disabled:C,className:"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 disabled:opacity-25 transition",children:"Tandai No-Show"})]})]})})]})}export{O as default};
