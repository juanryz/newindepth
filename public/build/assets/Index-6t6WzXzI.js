import{a as k,r as m,u as o,j as e,H as _}from"./app-Una0EcoJ.js";import{A as V}from"./AuthenticatedLayout-BZJ_Aq2B.js";import{P as p}from"./PrimaryButton-fniKrpNv.js";import{T}from"./TextInput-CGMkJohc.js";import"./transition-D45mW8OV.js";import"./ThemeToggle-D6Bw16ei.js";function A({transactions:n,therapists:u=[]}){const{flash:r}=k().props,[a,s]=m.useState(null),[i,l]=m.useState(null),{data:h,setData:j,post:g,reset:y}=o({rejection_reason:""}),{data:f,setData:d,post:c,processing:x,reset:b}=o({therapist_id:""}),N=t=>{t.transactionable_type.includes("Booking")?(l(t),d("therapist_id",t.transactionable?.therapist_id??"")):confirm("Validasi transaksi ini?")&&c(route("admin.transactions.validate",t.id))},v=t=>{t.preventDefault(),c(route("admin.transactions.validate",i.id),{onSuccess:()=>{l(null),b()}})},w=t=>{t.preventDefault(),g(route("admin.transactions.reject",a.id),{onSuccess:()=>{s(null),y()}})};return e.jsxs(V,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Dashboard Validasi Transaksi"}),children:[e.jsx(_,{title:"Validasi Transaksi"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[r.success&&e.jsx("div",{className:"p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50",children:r.success}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900 overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Inv"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tipe"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bank"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bukti"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.data.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.invoice_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.user?.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.transactionable_type.split("\\").pop()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.payment_bank}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600",children:t.payment_proof&&e.jsx("a",{href:`/storage/${t.payment_proof}`,target:"_blank",rel:"noreferrer",className:"underline",children:"Lihat Bukti"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                                    ${t.status==="paid"?"bg-green-100 text-green-800":t.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-3",children:t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>N(t),className:"text-green-600 hover:text-green-900",children:"Validasi"}),e.jsx("button",{onClick:()=>s(t),className:"text-red-600 hover:text-red-900",children:"Tolak"})]})})]},t.id))})]}),n.data.length===0&&e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"Belum ada transaksi."})]})})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4",children:["Tolak Pembayaran ",a.invoice_number]}),e.jsxs("form",{onSubmit:w,children:[e.jsx(T,{type:"text",className:"w-full mb-4",placeholder:"Alasan penolakan...",value:h.rejection_reason,onChange:t=>j("rejection_reason",t.target.value),required:!0}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>s(null),className:"text-gray-600",children:"Batal"}),e.jsx(p,{type:"submit",className:"bg-red-600",children:"Konfirmasi Penolakan"})]})]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:"Validasi Pembayaran"}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Invoice: ",i.invoice_number]}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pilih Terapis (opsional)"}),e.jsxs("select",{value:f.therapist_id,onChange:t=>d("therapist_id",t.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"— Tetap / Tanpa Perubahan —"}),u.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Jika tidak dipilih, terapis yang sudah ada sebelumnya akan dipertahankan."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>l(null),className:"text-gray-600",children:"Batal"}),e.jsx(p,{type:"submit",disabled:x,children:x?"Memvalidasi...":"Konfirmasi & Validasi"})]})]})]})})]})}export{A as default};
