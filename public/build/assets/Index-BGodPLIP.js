import{a as k,r as x,u as m,j as e,H as _}from"./app-TYZVcJBL.js";import{A as V}from"./AuthenticatedLayout-DkQ2xpzi.js";import{P as p}from"./PrimaryButton-BawUGl4N.js";import{T}from"./TextInput-CraIVmZp.js";import"./transition-D8pW4fop.js";import"./ThemeToggle-CmI0KIjU.js";import"./LiquidBackground-BABWgm1w.js";function I({transactions:n,therapists:u=[]}){const{flash:r}=k().props,[a,s]=x.useState(null),[i,l]=x.useState(null),{data:h,setData:g,post:b,reset:j}=m({rejection_reason:""}),{data:y,setData:d,post:c,processing:o,reset:f}=m({therapist_id:""}),N=t=>{t.transactionable_type.includes("Booking")?(l(t),d("therapist_id",t.transactionable?.therapist_id??"")):confirm("Validasi transaksi ini?")&&c(route("admin.transactions.validate",t.id))},v=t=>{t.preventDefault(),c(route("admin.transactions.validate",i.id),{onSuccess:()=>{l(null),f()}})},w=t=>{t.preventDefault(),b(route("admin.transactions.reject",a.id),{onSuccess:()=>{s(null),j()}})};return e.jsxs(V,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Dashboard Validasi Transaksi"}),children:[e.jsx(_,{title:"Validasi Transaksi"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[r.success&&e.jsx("div",{className:"p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50",children:r.success}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900 overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Inv"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tipe"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bank"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bukti"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.data.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.invoice_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.user?.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.transactionable_type.split("\\").pop()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.payment_bank}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.payment_proof?e.jsx("a",{href:`/storage/${t.payment_proof}`,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:text-blue-800 font-bold underline transition-colors",children:"Lihat Bukti"}):e.jsx("span",{className:"text-gray-400 italic",children:"—"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                                    ${t.status==="paid"?"bg-green-100 text-green-800":t.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-3",children:t.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(t),className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white text-[10px] font-bold uppercase tracking-wider rounded-md transition-all shadow-sm",children:"Validasi"}),e.jsx("button",{onClick:()=>s(t),className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white text-[10px] font-bold uppercase tracking-wider rounded-md transition-all shadow-sm",children:"Tolak"})]})})]},t.id))})]}),n.data.length===0&&e.jsx("p",{className:"text-center text-gray-500 mt-4",children:"Belum ada transaksi."})]})})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4",children:["Tolak Pembayaran ",a.invoice_number]}),e.jsxs("form",{onSubmit:w,children:[e.jsx(T,{type:"text",className:"w-full mb-4",placeholder:"Alasan penolakan...",value:h.rejection_reason,onChange:t=>g("rejection_reason",t.target.value),required:!0}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>s(null),className:"text-gray-600",children:"Batal"}),e.jsx(p,{type:"submit",className:"!bg-red-600 hover:!bg-red-500 !rounded-md !px-4 !py-2 !text-xs !tracking-widest !font-semibold !h-auto !shadow-none !uppercase",children:"Konfirmasi Penolakan"})]})]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-bold mb-1",children:"Validasi Pembayaran"}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Invoice: ",i.invoice_number]}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pilih Terapis (opsional)"}),e.jsxs("select",{value:y.therapist_id,onChange:t=>d("therapist_id",t.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"— Tetap / Tanpa Perubahan —"}),u.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Jika tidak dipilih, terapis yang sudah ada sebelumnya akan dipertahankan."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>l(null),className:"text-gray-600",children:"Batal"}),e.jsx(p,{type:"submit",disabled:o,className:"!bg-blue-600 hover:!bg-blue-500 !rounded-md !px-4 !py-2 !text-xs !tracking-widest !font-semibold !h-auto !shadow-none !uppercase",children:o?"Memvalidasi...":"Konfirmasi & Validasi"})]})]})]})})]})}export{I as default};
